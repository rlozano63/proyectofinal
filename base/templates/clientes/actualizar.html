{% extends 'AdminLTE/index.html' %}
{% load bootstrap %}
{% load static %}

{% block content %}

<form method="post" role="form">
    <legend>Clientes</legend>
    {% csrf_token %}
    {{ form|bootstrap }}
    <div class="form-group">
      <button type="submit" class="btn btn-primary">Editar</button>
    </div>
</form>

<input id="map-address">
<button type="button" onclick="currentLocation()"> Aqui</button>
<div id="somecomponent" style="width: 500px; height: 400px;"></div>

{% endblock content %}
{% block scripts %}
<script type="text/javascript" src='http://maps.google.com/maps/api/js?sensor=false&libraries=places&key=AIzaSyBIPRP1nZtRNuSSGzaANaE5GJIWo_BP_lc'></script>
<script src="{% static 'js/jquery-locationpicker-plugin/dist/locationpicker.jquery.js' %}"></script>
<script>
  $('#somecomponent').locationpicker({
    location: {
      latitude: 4.304709,
      longitude: -74.803034
    },
    radius: 300,
    inputBinding: {
      latitudeInput: $('#id_pos_x'),
      longitudeInput: $('#id_pos_y'),
      locationNameInput: $('#map-address')
    },
    enableAutocomplete: true,
    onchanged: function (currentLocation, radius, isMarkerDropped) {
      console.log("Location changed. New location (" + currentLocation.latitude + ", " + currentLocation.longitude + ")");
    }
  });
</script>
<script type="text/javascript">
  function localizacion(posicion) {
    console.log(posicion)

    var latitude = posicion.coords.latitude;
    var longitude = posicion.coords.longitude;
    //alert("tu latitude es: "+latitude+ "tu longitude es: " +longitude );
    //output.innerHTML = "<p>latitude:  "+ latitude+ "<br>longitude:  "+ longitude+"</p>";

    $("#id_pos_x").val(latitude).change()
    $("#id_pos_y").val(longitude).change()


  }

  function error() {
    //output.innerHTML = "<p> no se pudo obtener tu ubicacion</p>";
    alert("No se puedo obtener la posicion actual");
  }

  function currentLocation() {
    navigator.geolocation.getCurrentPosition(localizacion, error);
  }
</script> {% endblock scripts %}
